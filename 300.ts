/**
 * æœ€é•¿é€’å¢å­åºåˆ—
 * @param nums åŸæ•°ç»„
 * @description dp åˆå§‹åŒ–æ‰€æœ‰å€¼ä¸º1ï¼Œdp[i]è¡¨ç¤ºä¸ºnums[i]ç»“å°¾çš„æœ€é•¿é€’å¢å­åºåˆ—çš„é•¿åº¦ã€‚
 * è€Œdp[i]åˆšå¥½ç­‰äºä»–å‰é¢æ¯”nums[i]å°çš„å€¼ä¸­çš„æœ€å¤§çš„dpåŠ ä¸Š1 ã€‚
 * æ—¶é—´å¤æ‚åº¦ä¸º O(nÂ²) ç©ºé—´å¤æ‚åº¦ä¸º O(n)
 */
// function lengthOfLIS(nums: number[]): number {
//     const n = nums.length
//
//     // å®šä¹‰çŠ¶æ€ åˆå§‹åŒ–å€¼
//     const dp:number[] = new Array(n).fill(1)
//
//     // å¾ªç¯ çŠ¶æ€è½¬ç§»æ–¹ç¨‹
//     for (let i = 1; i < n; i++) {
//         for (let j = 0; j < i; j++) {
//             if (nums[j] < nums[i]) {
//                 dp[i] = Math.max(dp[i], dp[j] + 1)
//             }
//         }
//     }
//
//     return Math.max(...dp)
// };

/**
 * æœ€é•¿é€’å¢å­åºåˆ— - ä¼˜åŒ–
 * @param nums åŸæ•°ç»„
 */
// function lengthOfLIS(nums: number[]): number {
//     const n = nums.length
//
//     // å®šä¹‰çŠ¶æ€ åˆå§‹åŒ–å€¼
//     const dp:number[] = new Array(n).fill(1)
//     let max = dp[0]
//
//     // å¾ªç¯ çŠ¶æ€è½¬ç§»æ–¹ç¨‹
//     for (let i = 1; i < n; i++) {
//         for (let j = 0; j < i; j++) {
//             if (nums[j] < nums[i]) {
//                 dp[i] = Math.max(dp[i], dp[j] + 1)
//             }
//         }
//         max = Math.max(dp[i], max)
//     }
//
//     return max
// };

/**
 * æœ€é•¿é€’å¢å­åºåˆ— - äºŒåˆ†æŸ¥æ‰¾+è´ªå¿ƒ
 * @param nums åŸæ•°ç»„
 * @description æ—¶é—´å¤æ‚åº¦ä¸º O(nlogn) ã€‚éå†å…ƒç´ ä¸º O(n) äºŒåˆ†æŸ¥æ‰¾ä¸º O(logn) ã€‚
 * ç”¨ä¸€ä¸ªæ•°ç»„ tails ç»´æŠ¤å½“å‰æ‰€æœ‰é•¿åº¦çš„é€’å¢å­åºåˆ—çš„æœ€å°ç»“å°¾å€¼ï¼ˆè¶Šå°è¶Šå¥½ï¼Œæ–¹ä¾¿åé¢æ¥ä¸Šï¼‰ã€‚
 * éå†åŸæ•°ç»„ï¼Œå¯¹æ¯ä¸ªå…ƒç´  xï¼Œç”¨äºŒåˆ†æŸ¥æ‰¾åœ¨ tails ä¸­æ‰¾åˆ°ç¬¬ä¸€ä¸ª â‰¥ x çš„ä½ç½®å¹¶æ›¿æ¢ï¼ˆå¦‚æœæ²¡æ‰¾åˆ°å°±ç›´æ¥è¿½åŠ åˆ°æœ«å°¾ï¼‰ã€‚
 * tails çš„é•¿åº¦å°±æ˜¯ LIS çš„é•¿åº¦ï¼Œå› ä¸ºå®ƒå§‹ç»ˆä¿å­˜äº†æœ€ä¼˜çš„â€œæ¥é¾™åŸºç¡€â€ã€‚
 * ğŸ” è´ªå¿ƒæ ¸å¿ƒä½“ç°åœ¨ï¼šæ€»æ˜¯è®©ç›¸åŒé•¿åº¦çš„ LIS æ‹¥æœ‰å°½å¯èƒ½å°çš„ç»“å°¾ï¼Œè¿™æ ·åç»­æ›´å®¹æ˜“æ¥ä¸Šæ›´å¤§çš„æ•°ï¼Œå½¢æˆæ›´é•¿åºåˆ—ã€‚
 */
function lengthOfLIS(nums: number[]): number {
    const n = nums.length
    // è®°å½•æ¯ä¸ªç»„ä¸­çš„æœ€å°å€¼
    const tails: number[] = []

    // éå†æ¯ä¸€ä¸ªå…ƒç´ 
    for (let i = 0; i < n; i++) {
        // äºŒåˆ†æŸ¥æ‰¾ï¼šæ‰¾ç¬¬ä¸€ä¸ª >= num çš„ç´¢å¼•
        const num = nums[i]
        let left = 0
        let right = tails.length - 1

        // åœ¨ tails ä¸­æ‰¾åˆ°ç¬¬ä¸€ä¸ª â‰¥ num çš„ä½ç½®ï¼Œå¹¶ç”¨ num æ›¿æ¢ï¼Œç»´æŒ tails é€’å¢
        while (left <= right) {
            const mid = Math.floor((left+right) / 2)
            if (num <= tails[mid]) {
                // å½“ num === tails[mid] çš„æ—¶å€™ï¼Œä¹Ÿè¦æ›´æ–° right=mid-1ï¼Œæ˜¯å› ä¸ºéœ€è¦æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ¯”numå°çš„ï¼Œæ‰€ä»¥è¿˜è¦ç»§ç»­å‘å·¦æ”¶ç¼©
                right = mid - 1
            } else {
                left = mid + 1
            }
        }

        // æ˜¯å¦æ‰¾åˆ°å¯ä»¥å­˜æ”¾çš„ä½ç½®
        if (left === tails.length) {
            // æ²¡æœ‰æ‰¾åˆ°ä½ç½® eg: å‡å¦‚æ·»åŠ ä¸€ä¸ªå¾ˆå¤§çš„æ•°(æ‰¾ä¸åˆ°ä½ç½®)ï¼Œé‚£ä¹ˆæœ€å left>rightï¼Œåˆšå¥½ left åœ¨ tails.length çš„ä½ç½®
            // æ‰©å±•é•¿åº¦
            tails.push(num)
        } else {
            // å¦‚æœæ‰¾åˆ°ä½ç½® eg: å‡å¦‚æ·»åŠ ä¸€ä¸ªå¾ˆå°çš„æ•°ï¼Œé‚£ä¹ˆæœ€å right æŒ‡å‘ -1ï¼Œleft æŒ‡å‘ 0 ç´¢å¼•ï¼Œæ‰€ä»¥ç›´æ¥ç»™ num èµ‹å€¼åˆ° left å³å¯
            // è´ªå¿ƒæ›¿æ¢
            tails[left] = num
        }
    }
    return tails.length
};

/*
è´ªå¿ƒ+äºŒåˆ† æ€è€ƒè¿‡ç¨‹ï¼š
    åŸæ•°ç»„ï¼š 10 9 2 4 3 7 101 18
    æ€è·¯ï¼š  10 4 7 101           => 2 3 7 18 ä¸ºæœ€é•¿é€’å¢å­åºåˆ—
           9  3   18
           2
* */
